<!DOCTYPE html>
<html lang="es">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>Iniciar Sesión | Reserva de Canchas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="icon" type="image/x-icon" href="/static/icons/favicon.ico">
    <link rel="manifest" href="{% static 'manifest.webmanifest' %}">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Reserva">
    <link rel="apple-touch-icon" href="{% static 'icons/apple-touch-icon.png' %}">
    <link rel="stylesheet" href="{% static 'css/login_register/login_register.css' %}">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


</head>

<body class="min-h-screen flex items-center justify-center p-4 relative">
    <!-- Floating background shapes -->
    <div class="floating-shapes"></div>

    <div class="w-full max-w-md relative z-10">
        <!-- Logo and Header -->
        <div class="text-center mb-8 logo-container">
            <div class="mx-auto w-24 h-24 bg-white rounded-full flex items-center justify-center shadow-xl mb-4">
                <img src="{% static 'images/login_register/MinisterioDeportes.webp' %}"
                     alt="Logo Ministerio de Deportes"
                     class="h-16 w-auto">
            </div>
            <h1 class="text-3xl font-bold text-white mb-2">Reserva de Canchas</h1>
            <p class="text-blue-100">Sistema de Reservas Deportivas</p>
        </div>

        <!-- Form Container -->
        <div class="glass-effect rounded-2xl shadow-2xl p-8 form-container">
            <!-- Error Messages -->
            {% if messages %}
            <div class="mb-6 space-y-2">
                {% for message in messages %}
                <div class="error-message bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm">
                    <i class="fas fa-exclamation-circle mr-2"></i>{{ message }}
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <!-- Form Switch Container -->
            <div class="form-switch">
                <!-- Login Form -->
                <form method="post" id="loginForm" class="form-content">
                    {% csrf_token %}

                    <div class="text-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Iniciar Sesión</h2>
                        <p class="text-gray-600">Accede a tu cuenta para reservar canchas</p>
                    </div>

                    <div class="space-y-4">
                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-envelope mr-2 text-blue-600"></i>Correo Electrónico
                            </label>
                            <input type="email"
                                   name="email"
                                   placeholder="tu@email.com"
                                   required
                                   class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>

                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-lock mr-2 text-blue-600"></i>Contraseña
                            </label>
                            <input type="password"
                                   name="password"
                                   placeholder="••••••••"
                                   required
                                   class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <button type="submit"
                            name="login"
                            class="btn-primary w-full text-white py-3 px-4 rounded-xl font-semibold mt-6 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                        <i class="fas fa-sign-in-alt mr-2"></i>Iniciar Sesión
                    </button>

                    <div class="mt-6 text-center space-y-3">
                        <a href="{% url 'account-recovery' %}"
                           class="text-red-600 hover:text-red-700 text-sm font-medium transition-colors">
                            ¿Olvidaste tu contraseña?
                        </a>
                        <div class="text-gray-600 text-sm">
                            ¿No tienes cuenta?
                            <button type="button"
                                    onclick="toggleForm()"
                                    class="text-blue-600 hover:text-blue-700 font-semibold transition-colors">
                                Regístrate aquí
                            </button>
                        </div>
                    </div>
                </form>

                <!-- Register Form -->
                <form method="post" id="registerForm" class="form-content hidden">
                    {% csrf_token %}

                    <div class="text-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Crear Cuenta</h2>
                        <p class="text-gray-600">Únete para reservar canchas deportivas</p>
                    </div>

                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="input-group">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nombre</label>
                                <input type="text"
                                       name="first_name"
                                       placeholder="Juan"
                                       required
                                       class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div class="input-group">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Apellido</label>
                                <input type="text"
                                       name="last_name"
                                       placeholder="Pérez"
                                       required
                                       class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                        </div>

                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-id-card mr-2 text-blue-600"></i>Cédula o Pasaporte
                            </label>
                            <input type="text"
                                   name="identification_id"
                                   placeholder="000-0000000-0"
                                   required
                                   class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>

                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-calendar mr-2 text-blue-600"></i>Fecha de Nacimiento
                            </label>
                            <input type="date"
                                   name="dob"
                                   required
                                   class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>

                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-venus-mars mr-2 text-blue-600"></i>Género
                            </label>
                            <select name="gender"
                                    required
                                    class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">Selecciona tu género</option>
                                <option value="M">Masculino</option>
                                <option value="F">Femenino</option>
                                <option value="O">Otro</option>
                                <option value="N">Prefiero no decir</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-envelope mr-2 text-blue-600"></i>Correo Electrónico
                            </label>
                            <input type="email"
                                   name="email"
                                   placeholder="tu@email.com"
                                   required
                                   class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>

                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-lock mr-2 text-blue-600"></i>Contraseña
                            </label>
                            <input type="password"
                                   name="password"
                                   placeholder="••••••••"
                                   required
                                   class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>

                        <div class="input-group">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-lock mr-2 text-blue-600"></i>Confirmar Contraseña
                            </label>
                            <input type="password"
                                   name="confirm_password"
                                   placeholder="••••••••"
                                   required
                                   class="input-field w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <button type="submit"
                            name="register"
                            class="btn-secondary w-full text-white py-3 px-4 rounded-xl font-semibold mt-6 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2">
                        <i class="fas fa-user-plus mr-2"></i>Crear Cuenta
                    </button>

                    <div class="mt-6 text-center">
                        <div class="text-gray-600 text-sm">
                            ¿Ya tienes cuenta?
                            <button type="button"
                                    onclick="toggleForm()"
                                    class="text-blue-600 hover:text-blue-700 font-semibold transition-colors">
                                Inicia sesión aquí
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-blue-100">
            <p class="text-sm">© 2024 Ministerio de Deportes</p>
            <p class="text-xs">Sistema de Reservas Deportivas</p>
        </div>
    </div>

    <script>
        function toggleForm() {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');

            loginForm.classList.toggle('hidden');
            registerForm.classList.toggle('hidden');


        }

        // Form validation
        document.addEventListener('DOMContentLoaded', function() {
            const forms = document.querySelectorAll('form');

            forms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    const submitBtn = form.querySelector('button[type="submit"]');
                    const originalText = submitBtn.innerHTML;

                    // Show loading state
                    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Procesando...';
                });
            });

            // Password confirmation validation for register form
            const registerForm = document.getElementById('registerForm');
            const password = registerForm.querySelector('input[name="password"]');
            const confirmPassword = registerForm.querySelector('input[name="confirm_password"]');

            confirmPassword.addEventListener('input', function() {
                if (password.value !== confirmPassword.value) {
                    confirmPassword.setCustomValidity('Las contraseñas no coinciden');
                } else {
                    confirmPassword.setCustomValidity('');
                }
            });

            // Auto-hide error messages
            const errorMessages = document.querySelectorAll('.error-message');
            errorMessages.forEach(msg => {
                setTimeout(() => {
                    msg.style.animation = 'fadeOut 0.5s ease-out forwards';
                    setTimeout(() => msg.remove(), 500);
                }, 5000);
            });
        });

        // Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register("{% static 'service-worker.js' %}")
                .then(reg => console.log("Service Worker registrado:", reg))
                .catch(err => console.error("Fallo al registrar Service Worker:", err));
        }
    </script>
</body>
</html>